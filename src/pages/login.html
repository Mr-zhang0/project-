<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Bootstrap Material Admin</title>
    <meta name="description" content="" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="robots" content="all,follow" />
    <link
      rel="stylesheet"
      href="https://ajax.aspnetcdn.com/ajax/bootstrap/4.2.1/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="../sass/login.css" id="theme-stylesheet" />
  </head>
  <body>
    <div id="loginform">
      <div id="facebook">
        <i class="fa fa-facebook"></i>
        <div id="connect">Connect with Facebook</div>
      </div>
      <div id="mainlogin">
        <div id="or">or</div>
        <h1>Log in with awesome new thing</h1>
        <form action="#">
          <input type="text" class="username" placeholder="用户名" value="" />
          <input type="password" class="password" placeholder="密码" value="" />
          <button type="submit" class="login">
            <i class="fa fa-arrow-right"></i>
          </button>
        </form>
        <div id="note"><a href="./register.html">注册</a></div>
      </div>
    </div>
    <script src="../lib/jquery/dist/jquery.min.js"></script>
    <script>
      var nameInp = document.querySelector(".username");
      var passInp = document.querySelector(".password");
      var errorInfo = document.querySelector(".login");
      var form = document.querySelector("form");
      form.onsubmit = function(e) {
        e = e || window.event;
        e.preventDefault();
        var uname = nameInp.value;
        var upass = passInp.value;
        if (!uname || !upass) {
          alert("请完整填写表单");
          return;
        }
        $.ajax({
          url: "/login",
          type: "post",
          data: {
            username: uname,
            password: upass
          },
          dataType: "json",
          success: function(res) {
            console.log(res);

            if (res.code === 0) {
              alert("登录失败");
            } else {
              window.location.href = "./index.html";
            }
          }
        });
      };
    </script>
  </body>
</html>
